#### 事件与回调函数
```js
const http = require('http');
const queryStirng = require('queryString');

http.createServer(function (req,res) {
    let postData = '';
    req.setEncoding('utf-8');
    req.on('data', function (chunk) {
        postData += chunk;
    });
    req.on('end', function () {
        res.end(postData);
    })
}).listen(8080);
console.log('服务器启动完成');
```
#### 单线程
Node保持了JavaScript在浏览器中单线程的特点。而且在node中，JavaScript与其余线程是无法共享任何状态的。单线程的最大好处是不用像多线程编程那样处处在意状态的同步问题，这里没有死锁的存在，也没有线程上下文交换所带来的性能上的开销。
单线程的弱点：
* 无法利用多核cpu
* 错误会引起整个应用退出，应用的健壮性值得考验
* 大量计算占用cpu导致无法继续调用异步I/O

node采用了与web workers相同的思路来解决单线程中大量计算的问题：child_process

### 模块机制
#### CommonJS的模块规范
CommonJS对模块的定义十分简单，主要分为模块引用、模块定义和模块标识3个部分
#### 1、模块引用
```js
var math = require('math');
```
#### 2、模块定义
在模块中，上下文提供require()方法来引入外部模块。对应引入的功能，上下文提供了exports对象用于导出当前模块的方法或者变量，并且它是唯一导出的出口。在模块中，还存在一个module对象，他代表模块自身，而exports是module的属性。在node中，一个文件就是一个模块，将方法挂载在exports对象上作为属性即可定义导出的方式：
```js
//math.js
exports.add = function () {
    var sum = 0,
    i = 0,
    args = arguments,
    l = args.length;
    while(i < l) {
        sum += args[i];
    }
    return sum;
};
```
```js
//program.js
var math = require('math');
export.increment = function (val) {
    return math.add(val, 1);
}
```
#### 模块标识
模块的标识其实就是传递给require()方法的参数，他必须是符合小驼峰命名的字符串，或者以.、..开头的相对路径或者绝对路径。他可以没有文件名后缀

### Node的模块实现
在node中引入模块，需要经历如下3个步骤：

(1)路径分析

(2)文件定位

(3)编译执行

在node中，模块分为两类：一类是node提供的模块，成为核心模块；另一类是用户编写的模块，成为文件模块。
* 核心模块在node源代码的编译过程中，编译进了二进制执行文件。在node进程启动时，部分核心模块就被直接加载进内存中，所以这部分核心模块引入时，文件定位和编译执行这两个步骤可以省略掉，并且在路径分析中优先判断，所以他的加载速度是最快的
* 文件模块则是在运行时动态加载，需要完整的路径分析、文件定位、编译执行过程，速度比核心模块慢
#### 优先从缓存加载
与浏览器会缓存静态脚本文件以提高性能一样，node对引入过的模块都会进行缓存，以减少第二次引入时的开销。不同的地方在于，浏览器仅仅缓存文件，而node缓存的是编译和执行之后的对象
#### 路径分析和文件定位
1、模块标识符分析
模块标识符有一下几类：
* 核心模块，如http、fs、path等
* .或..开始的相对路径文件模块
* 以/开始的绝对路径文件模块
* 非路径形式的文件模块，如自己定义的connect模块
##### 核心模块
核心模块的优先级仅次于缓存加载，他在node的源代码编译过程中已经编译为二进制代码，其加载过程最快
##### 路径形式的文件模块
以.、..和/开始的标识符，这里都被当做文件模块来处理。在分析文件模块时，require()方法会将路径转为真实路劲，并以真实路径作为索引，将编译执行后的结果存放到缓存中，以使二次加载更快
由于文件模块个node指明了确切的文件位置，所以再查找过程中可以节约大量时间，其加载速度慢于核心模块。
##### 自定义模块
自定义模块指的是非核心模块，也不是路径形式的标识符。他是一种特殊的文件模块，可能是一个文件或者包的形式。这类模块的查找是最费时的，也是所有方式中最慢的一种
